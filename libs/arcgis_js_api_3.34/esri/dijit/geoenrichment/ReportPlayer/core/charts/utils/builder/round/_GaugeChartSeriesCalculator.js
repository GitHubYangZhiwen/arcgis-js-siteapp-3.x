// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.34/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/charts/utils/builder/round/_GaugeChartSeriesCalculator","../../ThemeCalculator ../../ChartTypes ../../ChartJsonUtil ../../ChartLineStyles ../../../../supportClasses/conditionalStyling/ConditionalStyleUtil ../../../../supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder ../utils/ChartDataUtil ../utils/TooltipInfoBuilder esri/dijit/geoenrichment/utils/ColorUtil".split(" "),function(I,x,J,h,y,K,z,L,A){var M={calcLineStyle:function(d,g){return{color:A.getColorWithAlpha(g.outlineColor||
d,g.outlineOpacity),width:g.outlineThickness,style:h.toGFXValue(g.outlineStyle||h.SOLID)}}};return{calcSeries:function(d){var g=d.seriesItems,k=d.chartType,h=d.themeSettings,B=d.viewModel,b=d.visualProperties,C=d.currentFeatureIndex,D=[],n=g[0],E={name:"data",data:[]},l=[],p=0,F=0,q=1E6,r=-1E6,G,f=n.points.slice();1===f.length&&f.push(J.getGaugeOthersPoint());if(x.isConditionalStylingSupported(k)&&b.conditionalStyling){var H=y.getStatistics(b.conditionalStyling);G=H&&z.getChartData({conditionalStats:H,
numPoints:f.length})}var N=K.isFieldInfoInPercentState(f[0].fieldInfo);f.forEach(function(a,c){1!==c?a=z.getPointValue({point:a,index:0,seriesIndex:0,maxValue:!1,chartType:k,visualProperties:b,viewModel:B,currentFeatureIndex:C,chartData:G}):(a=l[0],a=b.gaugeRangeMax?Math.max(0,b.gaugeRangeMax-a):N?Math.max(0,100-a):0);a=(l[c]=a)||0;p+=a;F+=Math.abs(a);q=Math.min(q,a);r=Math.max(r,a)});0===l[1]&&(f.length=1);var O=p/f.length,P=0>b.gaugeRangeMin||0>l[0];f.forEach(function(a,c){var m=1===c,t=l[c],u=
t||0,e;x.isConditionalStylingSupported(k)&&b.conditionalStyling&&(e=(e=y.getConditionalStyle(u,b.conditionalStyling))&&e.backgroundColor,m&&!b.gaugeConditionalStylingOthers&&(e=void 0));e=e||I.calcColorForPoint({point:a,seriesItem:n,pointIndex:c,isOthersPoint:m,seriesIndex:0,numSeries:g.length,chartType:k,themeSettings:h});var v=M.calcLineStyle(e,b);e=1>b.fillOpacity?A.getColorWithAlpha(e,b.fillOpacity):e;var w=u;m||b.gaugeRangeMin&&(w=Math.max(0,w-b.gaugeRangeMin));c={originalValue:t,x:1,y:Math.max(1E-4,
w),isUnavailableData:isNaN(t),valueProp:"y",unsortedIndex:c,name:a.label,point:a,fill:e,fieldInfo:f[0].fieldInfo,seriesIndex:0,isOthersPoint:m,stroke:{color:v.color,width:v.width,style:v.style}};a=L.getTooltipInfo({yValue:u,pointLabel:a.label,seriesLabel:null,minInSeriesValue:q,maxInSeriesValue:r,sumInSeriesValue:p,absSumInSeriesValue:F,avgInSeriesValue:O,visualProperties:b,chartType:k,conditionalStyling:b.conditionalStyling,fieldInfo:f[0].fieldInfo,decimals:a.value&&a.value.decimals,hasNegativeValues:P,
fill:c.fill,stroke:0<c.stroke.width?c.stroke.color:void 0,chartContainer:d.chartContainer,viewModel:B,theme:d.theme,themeSettings:h,dataDrillingPanelInfo:d.dataDrillingPanelInfo,pointName:a.label,seriesName:n.label,areaName:null,featureIndex:C,isComparisonPoint:!1,comparisonFeatureAttribute:null});c.tooltip=a;E.data.push(c)});D.push(E);return D}}});